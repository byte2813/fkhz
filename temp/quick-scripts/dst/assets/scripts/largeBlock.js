
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/largeBlock.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '12822Eg2DFIEKtzZYG/yQ1B', 'largeBlock');
// scripts/largeBlock.js

"use strict";

var global = require('global');

cc.Class({
  "extends": cc.Component,
  properties: {
    color: '',
    collider: {
      "default": null,
      type: cc.PolygonCollider
    },
    blocktype: ''
  },
  start: function start() {
    this._oldPos = this.node.position;
  },
  onLoad: function onLoad() {
    cc.director.getCollisionManager().enabled = true;
    this.hit = false; // 触摸事件开始

    this.node.on(cc.Node.EventType.TOUCH_START, function (touch, event) {
      var touchLoc = touch.getLocation();

      if (cc.Intersection.pointInPolygon(touchLoc, this.collider.world.points)) {
        console.log(this.node.blocktype);
        this.hit = true; // 启用缓动动画
        // cc.tween(this.node).to(.15, {
        //   position: cc.v2(touchLoc.x - this.node.parent.width / 2, touchLoc.y - this.node.parent.height / 2)
        // }, {
        //   easing: 'quadIn'
        // }).start()

        if (this.hit && this.node.blocktype == 'large') {
          this.node.x = touchLoc.x - this.node.parent.width / 2;
          this.node.y = touchLoc.y - this.node.parent.height / 2;
        }
      }
    }, this); // 触摸事件监听

    this.node.on(cc.Node.EventType.TOUCH_MOVE, function (touch, event) {
      var touchLoc = touch.getLocation();

      if (this.hit && this.node.blocktype == 'large') {
        this.node.x += touch.getDelta().x;
        this.node.y += touch.getDelta().y;
        touchLoc.x = touchLoc.x - this.node.parent.width / 2;
        touchLoc.y = touchLoc.y - this.node.parent.height / 2;

        if (touchLoc.x > 0 && touchLoc.y > 0) {
          this.node.angle = Math.atan(touchLoc.y / touchLoc.x) / Math.PI * 180 + 90 - 22.5;
        } else if (touchLoc.x < 0 && touchLoc.y > 0) {
          this.node.angle = Math.atan(-touchLoc.x / touchLoc.y) / Math.PI * 180 + 180 - 22.5;
        } else if (touchLoc.x < 0 && touchLoc.y < 0) {
          this.node.angle = Math.atan(-touchLoc.y / -touchLoc.x) / Math.PI * 180 + 270 - 22.5;
        } else if (touchLoc.x > 0 && touchLoc.y < 0) {
          this.node.angle = Math.atan(touchLoc.x / -touchLoc.y) / Math.PI * 180 - 22.5;
        } else if (touchLoc.x == 0 && touchLoc.y > 0) {
          this.node.angle = 180 - 22.5;
        } else if (touchLoc.x == 0 && touchLoc.y < 0) {
          this.node.angle = 0 - 22.5;
        } else if (touchLoc.x > 0 && touchLoc.y == 0) {
          this.node.angle = 90 - 22.5;
        } else if (touchLoc.x < 0 && touchLoc.y == 0) {
          this.node.angle = 270 - 22.5;
        }
      }
    }, this); // 触摸事件结束

    this.node.on(cc.Node.EventType.TOUCH_END, function (touch, event) {
      var _this = this;

      if (this.hit && this.node.blocktype == 'large') {
        this.hit = false; // 记录当前放置的位置

        var currentindex = -1;
        var points = global.outsidepoints; // 没有移动到圆环目标位置区域，移动到初始位置

        if (this.node.x * this.node.x + this.node.y * this.node.y > 1074 * 1074 / 4 || this.node.x * this.node.x + this.node.y * this.node.y < 574 * 574 / 4) {
          if (touch.getLocation().x - this.node.parent.width / 2 < 0) this.easeTo(this._oldPos.x, this._oldPos.y, 337.5, .2);else this.easeTo(this._oldPos.x, this._oldPos.y, -22.5, .2);
        } else {
          // 移动到了圆环目标位置区域
          if (this.node.x > 0 && this.node.y < 0) currentindex = this.node.x < -this.node.y ? 0 : 1;
          if (this.node.x > 0 && this.node.y > 0) currentindex = this.node.x > this.node.y ? 2 : 3;
          if (this.node.x < 0 && this.node.y > 0) currentindex = -this.node.x < this.node.y ? 4 : 5;
          if (this.node.x < 0 && this.node.y < 0) currentindex = -this.node.x > -this.node.y ? 6 : 7; // 标记当前位置是否为空

          var isempty = true; // 在对应圆环已放置的数组中查找

          global.outsideblocks.forEach(function (item) {
            if (item.index == currentindex) isempty = false; // 找到说明当前位置不可用
          }); // 当前位置若为空

          if (isempty && this.node.x != 0 && this.node.y != 0) {
            //计算旋转角度
            global.Lchangeangle += 45 * parseInt(this.game.rotateGridsL.string); //计算块的真正位置

            var n = (currentindex + global.Lchangeposition) % 8;
            if (n < 0) n += 8; // //更改块的父节点
            // this.node.removeFromParent(false);
            // this.game.outside.addChild(this.node);
            // //放置块
            // this.node.x = points[n].x
            // this.node.y = points[n].y
            // this.node.angle = points[n].a
            //放置块的缓动效果

            cc.tween(this.node).to(.2, {
              x: points[currentindex].x,
              y: points[currentindex].y,
              angle: points[currentindex].a
            }, {
              easing: 'quadIn'
            }).call(function () {
              //放置块
              _this.node.x = points[n].x;
              _this.node.y = points[n].y;
              _this.node.angle = points[n].a; //更改块的父节点

              _this.node.removeFromParent(false);

              _this.game.outside.addChild(_this.node); //环旋转的缓动效果


              cc.tween(_this.game.outside).to(Math.abs(parseInt(_this.game.rotateGridsL.string)) / 4, {
                angle: global.Lchangeangle
              }, {
                easing: 'quadIn'
              }).call(function () {
                _this.game.deleteBlock(); // 播放音效


                cc.audioEngine.playEffect(_this.game.rotateAudio, false);
              }).start();
            }).start(); // 构造当前块的对象，用于保存在圆环对象数组中

            var block = {
              index: currentindex,
              // 块的位置序号
              color: this.node.color._val,
              // 块的颜色
              rotateGridsL: this.game.rotateGridsL.string,
              // 块的转动格数
              blockitem: this
            };
            console.log(block); // 保存在圆环对象数组中

            global.outsideblocks.push(block); // 播放音效

            cc.audioEngine.playEffect(this.game.placeAudio, false); // //环旋转的缓动效果
            // cc.tween(this.game.outside).to(Math.abs(parseInt(this.game.rotateGridsL.string)) / 4, {
            //   angle: global.Lchangeangle
            // }, {
            //   easing: 'quadIn'
            // }).call(() => {
            //   this.game.deleteBlock();
            //   // 播放音效
            //   cc.audioEngine.playEffect(this.game.rotateAudio, false);
            // }).start()
            //计算在数组中的位置

            global.Lchangeposition -= parseInt(this.game.rotateGridsL.string); //更新数组中所有块的位置

            global.outsideblocks.forEach(function (item) {
              item.index = (item.index + parseInt(_this.game.rotateGridsL.string)) % 8;
              if (item.index < 0) item.index += 8;
            }); //console.log("global.outsideblocks: ")
            //console.log(global.outsideblocks)
            // 将当前块设置为不可点击

            this.node.blocktype = 'outside'; // 放置次数加1

            global.count++; // 如果三个块均已放置完毕，则重新生成三个块

            if (global.count != 0 && global.count % 3 == 0) {
              this.game.spawnBlock();
            }
          } else {
            // 当前位置若不为空，移动到初始位置
            if (touch.getLocation().x - this.node.parent.width / 2 < 0) this.easeTo(this._oldPos.x, this._oldPos.y, 337.5, .2);else this.easeTo(this._oldPos.x, this._oldPos.y, -22.5, .2);
          }
        }
      }
    }, this);
  },
  // 缓动函数
  easeTo: function easeTo(x, y, a, t) {
    cc.tween(this.node).to(t, {
      position: cc.v2(x, y),
      angle: a
    }, {
      easing: 'quadIn'
    }).start();
  },
  onDisable: function onDisable() {
    cc.director.getCollisionManager().enabled = false;
    cc.director.getCollisionManager().enabledDebugDraw = false;
    this.node.off(cc.Node.EventType.TOUCH_START);
    this.node.off(cc.Node.EventType.TOUCH_MOVE);
    this.node.off(cc.Node.EventType.TOUCH_END);
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcbGFyZ2VCbG9jay5qcyJdLCJuYW1lcyI6WyJnbG9iYWwiLCJyZXF1aXJlIiwiY2MiLCJDbGFzcyIsIkNvbXBvbmVudCIsInByb3BlcnRpZXMiLCJjb2xvciIsImNvbGxpZGVyIiwidHlwZSIsIlBvbHlnb25Db2xsaWRlciIsImJsb2NrdHlwZSIsInN0YXJ0IiwiX29sZFBvcyIsIm5vZGUiLCJwb3NpdGlvbiIsIm9uTG9hZCIsImRpcmVjdG9yIiwiZ2V0Q29sbGlzaW9uTWFuYWdlciIsImVuYWJsZWQiLCJoaXQiLCJvbiIsIk5vZGUiLCJFdmVudFR5cGUiLCJUT1VDSF9TVEFSVCIsInRvdWNoIiwiZXZlbnQiLCJ0b3VjaExvYyIsImdldExvY2F0aW9uIiwiSW50ZXJzZWN0aW9uIiwicG9pbnRJblBvbHlnb24iLCJ3b3JsZCIsInBvaW50cyIsImNvbnNvbGUiLCJsb2ciLCJ4IiwicGFyZW50Iiwid2lkdGgiLCJ5IiwiaGVpZ2h0IiwiVE9VQ0hfTU9WRSIsImdldERlbHRhIiwiYW5nbGUiLCJNYXRoIiwiYXRhbiIsIlBJIiwiVE9VQ0hfRU5EIiwiY3VycmVudGluZGV4Iiwib3V0c2lkZXBvaW50cyIsImVhc2VUbyIsImlzZW1wdHkiLCJvdXRzaWRlYmxvY2tzIiwiZm9yRWFjaCIsIml0ZW0iLCJpbmRleCIsIkxjaGFuZ2VhbmdsZSIsInBhcnNlSW50IiwiZ2FtZSIsInJvdGF0ZUdyaWRzTCIsInN0cmluZyIsIm4iLCJMY2hhbmdlcG9zaXRpb24iLCJ0d2VlbiIsInRvIiwiYSIsImVhc2luZyIsImNhbGwiLCJyZW1vdmVGcm9tUGFyZW50Iiwib3V0c2lkZSIsImFkZENoaWxkIiwiYWJzIiwiZGVsZXRlQmxvY2siLCJhdWRpb0VuZ2luZSIsInBsYXlFZmZlY3QiLCJyb3RhdGVBdWRpbyIsImJsb2NrIiwiX3ZhbCIsImJsb2NraXRlbSIsInB1c2giLCJwbGFjZUF1ZGlvIiwiY291bnQiLCJzcGF3bkJsb2NrIiwidCIsInYyIiwib25E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LENBQUNtQixJQUFILENBQVFDLFNBQVIsQ0FBa0JpQixVQUFoQztBQUNBLFNBQUsxQixJQUFMLENBQVV3RSxHQUFWLENBQWNuRixFQUFFLENBQUNtQixJQUFILENBQVFDLFNBQVIsQ0FBa0J1QixTQUFoQztBQUNEO0FBck9NLENBQVQiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbInZhciBnbG9iYWwgPSByZXF1aXJlKCdnbG9iYWwnKTtcclxuXHJcbmNjLkNsYXNzKHtcclxuICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcbiAgcHJvcGVydGllczoge1xyXG4gICAgY29sb3I6ICcnLFxyXG4gICAgY29sbGlkZXI6IHtcclxuICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgdHlwZTogY2MuUG9seWdvbkNvbGxpZGVyXHJcbiAgICB9LFxyXG4gICAgYmxvY2t0eXBlOiAnJyxcclxuXHJcbiAgfSxcclxuXHJcbiAgc3RhcnQoKSB7XHJcbiAgICB0aGlzLl9vbGRQb3MgPSB0aGlzLm5vZGUucG9zaXRpb247XHJcbiAgfSxcclxuXHJcbiAgb25Mb2FkKCkge1xyXG4gICAgY2MuZGlyZWN0b3IuZ2V0Q29sbGlzaW9uTWFuYWdlcigpLmVuYWJsZWQgPSB0cnVlO1xyXG4gICAgdGhpcy5oaXQgPSBmYWxzZTtcclxuXHJcbiAgICAvLyDop6bmkbjkuovku7blvIDlp4tcclxuICAgIHRoaXMubm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9TVEFSVCwgZnVuY3Rpb24gKHRvdWNoLCBldmVudCkge1xyXG4gICAgICB2YXIgdG91Y2hMb2MgPSB0b3VjaC5nZXRMb2NhdGlvbigpO1xyXG4gICAgICBpZiAoY2MuSW50ZXJzZWN0aW9uLnBvaW50SW5Qb2x5Z29uKHRvdWNoTG9jLCB0aGlzLmNvbGxpZGVyLndvcmxkLnBvaW50cykpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLm5vZGUuYmxvY2t0eXBlKTtcclxuICAgICAgICB0aGlzLmhpdCA9IHRydWU7XHJcbiAgICAgICAgLy8g5ZCv55So57yT5Yqo5Yqo55S7XHJcbiAgICAgICAgLy8gY2MudHdlZW4odGhpcy5ub2RlKS50byguMTUsIHtcclxuICAgICAgICAvLyAgIHBvc2l0aW9uOiBjYy52Mih0b3VjaExvYy54IC0gdGhpcy5ub2RlLnBhcmVudC53aWR0aCAvIDIsIHRvdWNoTG9jLnkgLSB0aGlzLm5vZGUucGFyZW50LmhlaWdodCAvIDIpXHJcbiAgICAgICAgLy8gfSwge1xyXG4gICAgICAgIC8vICAgZWFzaW5nOiAncXVhZEluJ1xyXG4gICAgICAgIC8vIH0pLnN0YXJ0KClcclxuICAgICAgICBpZiAodGhpcy5oaXQgJiYgdGhpcy5ub2RlLmJsb2NrdHlwZSA9PSAnbGFyZ2UnKSB7XHJcbiAgICAgICAgICB0aGlzLm5vZGUueCA9IHRvdWNoTG9jLnggLSB0aGlzLm5vZGUucGFyZW50LndpZHRoIC8gMlxyXG4gICAgICAgICAgdGhpcy5ub2RlLnkgPSB0b3VjaExvYy55IC0gdGhpcy5ub2RlLnBhcmVudC5oZWlnaHQgLyAyXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9LCB0aGlzKTtcclxuXHJcbiAgICAvLyDop6bmkbjkuovku7bnm5HlkKxcclxuICAgIHRoaXMubm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9NT1ZFLCBmdW5jdGlvbiAodG91Y2gsIGV2ZW50KSB7XHJcbiAgICAgIHZhciB0b3VjaExvYyA9IHRvdWNoLmdldExvY2F0aW9uKCk7XHJcbiAgICAgIGlmICh0aGlzLmhpdCAmJiB0aGlzLm5vZGUuYmxvY2t0eXBlID09ICdsYXJnZScpIHtcclxuICAgICAgICB0aGlzLm5vZGUueCArPSB0b3VjaC5nZXREZWx0YSgpLng7XHJcbiAgICAgICAgdGhpcy5ub2RlLnkgKz0gdG91Y2guZ2V0RGVsdGEoKS55O1xyXG4gICAgICAgIHRvdWNoTG9jLnggPSB0b3VjaExvYy54IC0gdGhpcy5ub2RlLnBhcmVudC53aWR0aCAvIDJcclxuICAgICAgICB0b3VjaExvYy55ID0gdG91Y2hMb2MueSAtIHRoaXMubm9kZS5wYXJlbnQuaGVpZ2h0IC8gMlxyXG4gICAgICAgIGlmICh0b3VjaExvYy54ID4gMCAmJiB0b3VjaExvYy55ID4gMCkge1xyXG4gICAgICAgICAgdGhpcy5ub2RlLmFuZ2xlID0gTWF0aC5hdGFuKHRvdWNoTG9jLnkgLyB0b3VjaExvYy54KSAvIE1hdGguUEkgKiAxODAgKyA5MCAtIDIyLjVcclxuICAgICAgICB9IGVsc2UgaWYgKHRvdWNoTG9jLnggPCAwICYmIHRvdWNoTG9jLnkgPiAwKSB7XHJcbiAgICAgICAgICB0aGlzLm5vZGUuYW5nbGUgPSBNYXRoLmF0YW4oLXRvdWNoTG9jLnggLyB0b3VjaExvYy55KSAvIE1hdGguUEkgKiAxODAgKyAxODAgLSAyMi41XHJcbiAgICAgICAgfSBlbHNlIGlmICh0b3VjaExvYy54IDwgMCAmJiB0b3VjaExvYy55IDwgMCkge1xyXG4gICAgICAgICAgdGhpcy5ub2RlLmFuZ2xlID0gTWF0aC5hdGFuKC10b3VjaExvYy55IC8gLXRvdWNoTG9jLngpIC8gTWF0aC5QSSAqIDE4MCArIDI3MCAtIDIyLjVcclxuICAgICAgICB9IGVsc2UgaWYgKHRvdWNoTG9jLnggPiAwICYmIHRvdWNoTG9jLnkgPCAwKSB7XHJcbiAgICAgICAgICB0aGlzLm5vZGUuYW5nbGUgPSBNYXRoLmF0YW4odG91Y2hMb2MueCAvIC10b3VjaExvYy55KSAvIE1hdGguUEkgKiAxODAgLSAyMi41XHJcbiAgICAgICAgfSBlbHNlIGlmICh0b3VjaExvYy54ID09IDAgJiYgdG91Y2hMb2MueSA+IDApIHtcclxuICAgICAgICAgIHRoaXMubm9kZS5hbmdsZSA9IDE4MCAtIDIyLjVcclxuICAgICAgICB9IGVsc2UgaWYgKHRvdWNoTG9jLnggPT0gMCAmJiB0b3VjaExvYy55IDwgMCkge1xyXG4gICAgICAgICAgdGhpcy5ub2RlLmFuZ2xlID0gMCAtIDIyLjVcclxuICAgICAgICB9IGVsc2UgaWYgKHRvdWNoTG9jLnggPiAwICYmIHRvdWNoTG9jLnkgPT0gMCkge1xyXG4gICAgICAgICAgdGhpcy5ub2RlLmFuZ2xlID0gOTAgLSAyMi41XHJcbiAgICAgICAgfSBlbHNlIGlmICh0b3VjaExvYy54IDwgMCAmJiB0b3VjaExvYy55ID09IDApIHtcclxuICAgICAgICAgIHRoaXMubm9kZS5hbmdsZSA9IDI3MCAtIDIyLjVcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0sIHRoaXMpO1xyXG5cclxuICAgIC8vIOinpuaRuOS6i+S7tue7k+adn1xyXG4gICAgdGhpcy5ub2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0VORCwgZnVuY3Rpb24gKHRvdWNoLCBldmVudCkge1xyXG4gICAgICBpZiAodGhpcy5oaXQgJiYgdGhpcy5ub2RlLmJsb2NrdHlwZSA9PSAnbGFyZ2UnKSB7XHJcbiAgICAgICAgdGhpcy5oaXQgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgLy8g6K6w5b2V5b2T5YmN5pS+572u55qE5L2N572uXHJcbiAgICAgICAgbGV0IGN1cnJlbnRpbmRleCA9IC0xO1xyXG4gICAgICAgIGNvbnN0IHBvaW50cyA9IGdsb2JhbC5vdXRzaWRlcG9pbnRzXHJcblxyXG4gICAgICAgIC8vIOayoeacieenu+WKqOWIsOWchueOr+ebruagh+S9jee9ruWMuuWfn++8jOenu+WKqOWIsOWIneWni+S9jee9rlxyXG4gICAgICAgIGlmICh0aGlzLm5vZGUueCAqIHRoaXMubm9kZS54ICsgdGhpcy5ub2RlLnkgKiB0aGlzLm5vZGUueSA+IDEwNzQgKiAxMDc0IC8gNCB8fCB0aGlzLm5vZGUueCAqIHRoaXMubm9kZVxyXG4gICAgICAgICAgLnggKyB0aGlzLm5vZGUueSAqIHRoaXMubm9kZS55IDwgNTc0ICogNTc0IC8gNCkge1xyXG5cclxuICAgICAgICAgIGlmICh0b3VjaC5nZXRMb2NhdGlvbigpLnggLSB0aGlzLm5vZGUucGFyZW50LndpZHRoIC8gMiA8IDApXHJcbiAgICAgICAgICAgIHRoaXMuZWFzZVRvKHRoaXMuX29sZFBvcy54LCB0aGlzLl9vbGRQb3MueSwgMzM3LjUsIC4yKVxyXG4gICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB0aGlzLmVhc2VUbyh0aGlzLl9vbGRQb3MueCwgdGhpcy5fb2xkUG9zLnksIC0yMi41LCAuMilcclxuICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgIC8vIOenu+WKqOWIsOS6huWchueOr+ebruagh+S9jee9ruWMuuWfn1xyXG4gICAgICAgICAgaWYgKHRoaXMubm9kZS54ID4gMCAmJiB0aGlzLm5vZGUueSA8IDApIGN1cnJlbnRpbmRleCA9IHRoaXMubm9kZS54IDwgLXRoaXMubm9kZS55ID8gMCA6IDFcclxuICAgICAgICAgIGlmICh0aGlzLm5vZGUueCA+IDAgJiYgdGhpcy5ub2RlLnkgPiAwKSBjdXJyZW50aW5kZXggPSB0aGlzLm5vZGUueCA+IHRoaXMubm9kZS55ID8gMiA6IDNcclxuICAgICAgICAgIGlmICh0aGlzLm5vZGUueCA8IDAgJiYgdGhpcy5ub2RlLnkgPiAwKSBjdXJyZW50aW5kZXggPSAtdGhpcy5ub2RlLnggPCB0aGlzLm5vZGUueSA/IDQgOiA1XHJcbiAgICAgICAgICBpZiAodGhpcy5ub2RlLnggPCAwICYmIHRoaXMubm9kZS55IDwgMCkgY3VycmVudGluZGV4ID0gLXRoaXMubm9kZS54ID4gLXRoaXMubm9kZS55ID8gNiA6IDdcclxuXHJcbiAgICAgICAgICAvLyDmoIforrDlvZPliY3kvY3nva7mmK/lkKbkuLrnqbpcclxuICAgICAgICAgIGxldCBpc2VtcHR5ID0gdHJ1ZVxyXG5cclxuICAgICAgICAgIC8vIOWcqOWvueW6lOWchueOr+W3suaUvue9rueahOaVsOe7hOS4reafpeaJvlxyXG4gICAgICAgICAgZ2xvYmFsLm91dHNpZGVibG9ja3MuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgaWYgKGl0ZW0uaW5kZXggPT0gY3VycmVudGluZGV4KSBpc2VtcHR5ID0gZmFsc2UgLy8g5om+5Yiw6K+05piO5b2T5YmN5L2N572u5LiN5Y+v55SoXHJcbiAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAgIC8vIOW9k+WJjeS9jee9ruiLpeS4uuepulxyXG4gICAgICAgICAgaWYgKGlzZW1wdHkgJiYgdGhpcy5ub2RlLnggIT0gMCAmJiB0aGlzLm5vZGUueSAhPSAwKSB7XHJcblxyXG4gICAgICAgICAgICAvL+iuoeeul+aXi+i9rOinkuW6plxyXG4gICAgICAgICAgICBnbG9iYWwuTGNoYW5nZWFuZ2xlICs9IDQ1ICogcGFyc2VJbnQodGhpcy5nYW1lLnJvdGF0ZUdyaWRzTC5zdHJpbmcpXHJcblxyXG4gICAgICAgICAgICAvL+iuoeeul+Wdl+eahOecn+ato+S9jee9rlxyXG4gICAgICAgICAgICBsZXQgbiA9IChjdXJyZW50aW5kZXggKyBnbG9iYWwuTGNoYW5nZXBvc2l0aW9uKSAlIDhcclxuICAgICAgICAgICAgaWYgKG4gPCAwKVxyXG4gICAgICAgICAgICAgIG4gKz0gOFxyXG5cclxuICAgICAgICAgICAgLy8gLy/mm7TmlLnlnZfnmoTniLboioLngrlcclxuICAgICAgICAgICAgLy8gdGhpcy5ub2RlLnJlbW92ZUZyb21QYXJlbnQoZmFsc2UpO1xyXG4gICAgICAgICAgICAvLyB0aGlzLmdhbWUub3V0c2lkZS5hZGRDaGlsZCh0aGlzLm5vZGUpO1xyXG5cclxuICAgICAgICAgICAgLy8gLy/mlL7nva7lnZdcclxuICAgICAgICAgICAgLy8gdGhpcy5ub2RlLnggPSBwb2ludHNbbl0ueFxyXG4gICAgICAgICAgICAvLyB0aGlzLm5vZGUueSA9IHBvaW50c1tuXS55XHJcbiAgICAgICAgICAgIC8vIHRoaXMubm9kZS5hbmdsZSA9IHBvaW50c1tuXS5hXHJcblxyXG4gICAgICAgICAgICAvL+aUvue9ruWdl+eahOe8k+WKqOaViOaenFxyXG4gICAgICAgICAgICBjYy50d2Vlbih0aGlzLm5vZGUpLnRvKC4yLCB7XHJcbiAgICAgICAgICAgICAgeDogcG9pbnRzW2N1cnJlbnRpbmRleF0ueCxcclxuICAgICAgICAgICAgICB5OiBwb2ludHNbY3VycmVudGluZGV4XS55LFxyXG4gICAgICAgICAgICAgIGFuZ2xlOiBwb2ludHNbY3VycmVudGluZGV4XS5hLFxyXG4gICAgICAgICAgICB9LCB7XHJcbiAgICAgICAgICAgICAgZWFzaW5nOiAncXVhZEluJ1xyXG4gICAgICAgICAgICB9KS5jYWxsKCgpID0+IHtcclxuICAgICAgICAgICAgICAvL+aUvue9ruWdl1xyXG4gICAgICAgICAgICAgIHRoaXMubm9kZS54ID0gcG9pbnRzW25dLnhcclxuICAgICAgICAgICAgICB0aGlzLm5vZGUueSA9IHBvaW50c1tuXS55XHJcbiAgICAgICAgICAgICAgdGhpcy5ub2RlLmFuZ2xlID0gcG9pbnRzW25dLmFcclxuXHJcbiAgICAgICAgICAgICAgLy/mm7TmlLnlnZfnmoTniLboioLngrlcclxuICAgICAgICAgICAgICB0aGlzLm5vZGUucmVtb3ZlRnJvbVBhcmVudChmYWxzZSk7XHJcbiAgICAgICAgICAgICAgdGhpcy5nYW1lLm91dHNpZGUuYWRkQ2hpbGQodGhpcy5ub2RlKTtcclxuXHJcblxyXG4gICAgICAgICAgICAgIC8v546v5peL6L2s55qE57yT5Yqo5pWI5p6cXHJcbiAgICAgICAgICAgICAgY2MudHdlZW4odGhpcy5nYW1lLm91dHNpZGUpLnRvKE1hdGguYWJzKHBhcnNlSW50KHRoaXMuZ2FtZS5yb3RhdGVHcmlkc0wuc3RyaW5nKSkgLyA0LCB7XHJcbiAgICAgICAgICAgICAgICBhbmdsZTogZ2xvYmFsLkxjaGFuZ2VhbmdsZVxyXG4gICAgICAgICAgICAgIH0sIHtcclxuICAgICAgICAgICAgICAgIGVhc2luZzogJ3F1YWRJbidcclxuICAgICAgICAgICAgICB9KS5jYWxsKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2FtZS5kZWxldGVCbG9jaygpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIOaSreaUvumfs+aViFxyXG4gICAgICAgICAgICAgICAgY2MuYXVkaW9FbmdpbmUucGxheUVmZmVjdCh0aGlzLmdhbWUucm90YXRlQXVkaW8sIGZhbHNlKTtcclxuICAgICAgICAgICAgICB9KS5zdGFydCgpXHJcbiAgICAgICAgICAgIH0pLnN0YXJ0KClcclxuXHJcbiAgICAgICAgICAgIC8vIOaehOmAoOW9k+WJjeWdl+eahOWvueixoe+8jOeUqOS6juS/neWtmOWcqOWchueOr+WvueixoeaVsOe7hOS4rVxyXG4gICAgICAgICAgICBsZXQgYmxvY2sgPSB7XHJcbiAgICAgICAgICAgICAgaW5kZXg6IGN1cnJlbnRpbmRleCwgLy8g5Z2X55qE5L2N572u5bqP5Y+3XHJcbiAgICAgICAgICAgICAgY29sb3I6IHRoaXMubm9kZS5jb2xvci5fdmFsLCAvLyDlnZfnmoTpopzoibJcclxuICAgICAgICAgICAgICByb3RhdGVHcmlkc0w6IHRoaXMuZ2FtZS5yb3RhdGVHcmlkc0wuc3RyaW5nLCAvLyDlnZfnmoTovazliqjmoLzmlbBcclxuICAgICAgICAgICAgICBibG9ja2l0ZW06IHRoaXNcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc29sZS5sb2coYmxvY2spXHJcbiAgICAgICAgICAgIC8vIOS/neWtmOWcqOWchueOr+WvueixoeaVsOe7hOS4rVxyXG4gICAgICAgICAgICBnbG9iYWwub3V0c2lkZWJsb2Nrcy5wdXNoKGJsb2NrKVxyXG5cclxuICAgICAgICAgICAgLy8g5pKt5pS+6Z+z5pWIXHJcbiAgICAgICAgICAgIGNjLmF1ZGlvRW5naW5lLnBsYXlFZmZlY3QodGhpcy5nYW1lLnBsYWNlQXVkaW8sIGZhbHNlKTtcclxuXHJcbiAgICAgICAgICAgIC8vIC8v546v5peL6L2s55qE57yT5Yqo5pWI5p6cXHJcbiAgICAgICAgICAgIC8vIGNjLnR3ZWVuKHRoaXMuZ2FtZS5vdXRzaWRlKS50byhNYXRoLmFicyhwYXJzZUludCh0aGlzLmdhbWUucm90YXRlR3JpZHNMLnN0cmluZykpIC8gNCwge1xyXG4gICAgICAgICAgICAvLyAgIGFuZ2xlOiBnbG9iYWwuTGNoYW5nZWFuZ2xlXHJcbiAgICAgICAgICAgIC8vIH0sIHtcclxuICAgICAgICAgICAgLy8gICBlYXNpbmc6ICdxdWFkSW4nXHJcbiAgICAgICAgICAgIC8vIH0pLmNhbGwoKCkgPT4ge1xyXG4gICAgICAgICAgICAvLyAgIHRoaXMuZ2FtZS5kZWxldGVCbG9jaygpO1xyXG5cclxuICAgICAgICAgICAgLy8gICAvLyDmkq3mlL7pn7PmlYhcclxuICAgICAgICAgICAgLy8gICBjYy5hdWRpb0VuZ2luZS5wbGF5RWZmZWN0KHRoaXMuZ2FtZS5yb3RhdGVBdWRpbywgZmFsc2UpO1xyXG4gICAgICAgICAgICAvLyB9KS5zdGFydCgpXHJcblxyXG4gICAgICAgICAgICAvL+iuoeeul+WcqOaVsOe7hOS4reeahOS9jee9rlxyXG4gICAgICAgICAgICBnbG9iYWwuTGNoYW5nZXBvc2l0aW9uIC09IHBhcnNlSW50KHRoaXMuZ2FtZS5yb3RhdGVHcmlkc0wuc3RyaW5nKVxyXG5cclxuICAgICAgICAgICAgLy/mm7TmlrDmlbDnu4TkuK3miYDmnInlnZfnmoTkvY3nva5cclxuICAgICAgICAgICAgZ2xvYmFsLm91dHNpZGVibG9ja3MuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICBpdGVtLmluZGV4ID0gKGl0ZW0uaW5kZXggKyBwYXJzZUludCh0aGlzLmdhbWUucm90YXRlR3JpZHNMLnN0cmluZykpICUgODtcclxuICAgICAgICAgICAgICBpZiAoaXRlbS5pbmRleCA8IDApXHJcbiAgICAgICAgICAgICAgICBpdGVtLmluZGV4ICs9IDhcclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJnbG9iYWwub3V0c2lkZWJsb2NrczogXCIpXHJcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coZ2xvYmFsLm91dHNpZGVibG9ja3MpXHJcblxyXG4gICAgICAgICAgICAvLyDlsIblvZPliY3lnZforr7nva7kuLrkuI3lj6/ngrnlh7tcclxuICAgICAgICAgICAgdGhpcy5ub2RlLmJsb2NrdHlwZSA9ICdvdXRzaWRlJ1xyXG5cclxuICAgICAgICAgICAgLy8g5pS+572u5qyh5pWw5YqgMVxyXG4gICAgICAgICAgICBnbG9iYWwuY291bnQrK1xyXG5cclxuICAgICAgICAgICAgLy8g5aaC5p6c5LiJ5Liq5Z2X5Z2H5bey5pS+572u5a6M5q+V77yM5YiZ6YeN5paw55Sf5oiQ5LiJ5Liq5Z2XXHJcbiAgICAgICAgICAgIGlmIChnbG9iYWwuY291bnQgIT0gMCAmJiBnbG9iYWwuY291bnQgJSAzID09IDApIHtcclxuICAgICAgICAgICAgICB0aGlzLmdhbWUuc3Bhd25CbG9jaygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyDlvZPliY3kvY3nva7oi6XkuI3kuLrnqbrvvIznp7vliqjliLDliJ3lp4vkvY3nva5cclxuICAgICAgICAgICAgaWYgKHRvdWNoLmdldExvY2F0aW9uKCkueCAtIHRoaXMubm9kZS5wYXJlbnQud2lkdGggLyAyIDwgMClcclxuICAgICAgICAgICAgICB0aGlzLmVhc2VUbyh0aGlzLl9vbGRQb3MueCwgdGhpcy5fb2xkUG9zLnksIDMzNy41LCAuMilcclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgIHRoaXMuZWFzZVRvKHRoaXMuX29sZFBvcy54LCB0aGlzLl9vbGRQb3MueSwgLTIyLjUsIC4yKVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSwgdGhpcyk7XHJcbiAgfSxcclxuXHJcbiAgLy8g57yT5Yqo5Ye95pWwXHJcbiAgZWFzZVRvOiBmdW5jdGlvbiAoeCwgeSwgYSwgdCkge1xyXG4gICAgY2MudHdlZW4odGhpcy5ub2RlKS50byh0LCB7XHJcbiAgICAgIHBvc2l0aW9uOiBjYy52Mih4LCB5KSxcclxuICAgICAgYW5nbGU6IGFcclxuICAgIH0sIHtcclxuICAgICAgZWFzaW5nOiAncXVhZEluJ1xyXG4gICAgfSkuc3RhcnQoKVxyXG4gIH0sXHJcblxyXG4gIG9uRGlzYWJsZSgpIHtcclxuICAgIGNjLmRpcmVjdG9yLmdldENvbGxpc2lvbk1hbmFnZXIoKS5lbmFibGVkID0gZmFsc2U7XHJcbiAgICBjYy5kaXJlY3Rvci5nZXRDb2xsaXNpb25NYW5hZ2VyKCkuZW5hYmxlZERlYnVnRHJhdyA9IGZhbHNlO1xyXG4gICAgdGhpcy5ub2RlLm9mZihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9TVEFSVCk7XHJcbiAgICB0aGlzLm5vZGUub2ZmKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX01PVkUpO1xyXG4gICAgdGhpcy5ub2RlLm9mZihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9FTkQpO1xyXG4gIH0sXHJcblxyXG5cclxufSk7XHJcbiJdfQ==